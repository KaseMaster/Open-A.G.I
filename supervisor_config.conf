# Configuración Supervisor - AEGIS Framework
# Programador Principal: Jose Gómez alias KaseMaster
# Contacto: kasemaster@protonmail.com
# Versión: 2.0.0
# Licencia: MIT

[unix_http_server]
file=/var/run/supervisor.sock
chmod=0700

[supervisord]
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid
childlogdir=/var/log/supervisor

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///var/run/supervisor.sock

# Dashboard de Monitoreo AEGIS
[program:aegis-dashboard]
command=/opt/openagi/venv/bin/python /opt/openagi/main.py start-dashboard
directory=/opt/openagi
user=openagi
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/openagi/dashboard.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
environment=PYTHONPATH="/opt/openagi",ENVIRONMENT="production"

# Chat dApp PHP
[program:aegis-chat]
command=/usr/bin/php -S 0.0.0.0:8086 -t /opt/openagi/web/advanced-chat-php/public
directory=/opt/openagi/web/advanced-chat-php/public
user=openagi
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/openagi/chat.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10

# Red P2P
[program:aegis-p2p]
command=/opt/openagi/venv/bin/python /opt/openagi/main.py start-p2p
directory=/opt/openagi
user=openagi
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/openagi/p2p.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
environment=PYTHONPATH="/opt/openagi",ENVIRONMENT="production"

# Blockchain
[program:aegis-blockchain]
command=/opt/openagi/venv/bin/python /opt/openagi/main.py start-blockchain
directory=/opt/openagi
user=openagi
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/openagi/blockchain.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
environment=PYTHONPATH="/opt/openagi",ENVIRONMENT="production"

# Monitor de Sistema
[program:aegis-monitor]
command=/opt/openagi/venv/bin/python /opt/openagi/main.py system-monitor
directory=/opt/openagi
user=openagi
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/openagi/monitor.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
environment=PYTHONPATH="/opt/openagi",ENVIRONMENT="production"

# Servicio de Seguridad
[program:aegis-security]
command=/opt/openagi/venv/bin/python /opt/openagi/main.py security-service
directory=/opt/openagi
user=openagi
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/var/log/openagi/security.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
environment=PYTHONPATH="/opt/openagi",ENVIRONMENT="production"

# Grupo de servicios principales
[group:aegis-core]
programs=aegis-dashboard,aegis-chat,aegis-p2p,aegis-blockchain
priority=999

# Grupo de servicios auxiliares
[group:aegis-aux]
programs=aegis-monitor,aegis-security
priority=998